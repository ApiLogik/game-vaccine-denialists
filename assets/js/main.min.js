const onLoadGlobal=()=>{const gameScreen=document.querySelector(".game-screen"),btnIniciar=document.querySelector("#btn-ini"),startOptions=document.querySelector(".start-options"),countHits=document.querySelector(".panel span"),resultScreen=document.querySelector(".result"),clock=document.querySelector("#timer");let counter=0,gameOn=!1,paused=!1;window.innerHeight>window.innerWidth&&(startOptions.style.display="none",document.querySelector(".panel").style.display="none",document.querySelector(".orient").style.display="block"),window.addEventListener("orientationchange",()=>location.reload());const preLoadImages=()=>{const target1=new Image,target2=new Image,target3=new Image,targetHit1=new Image,targetHit2=new Image,targetHit3=new Image,cloroqImg=new Image,serynge=new Image,loadedImages=[[target1,target2,target3],[targetHit1,targetHit2,targetHit3],cloroqImg,serynge];cloroqImg.src="assets/media/cloroq_alt.png",serynge.src="assets/media/seringa_icone.png";for(let i=0;i<=2;i++)loadedImages[0][i].src=`assets/media/negac${i+1}.png`,"pt-BR"===document.documentElement.lang?loadedImages[1][i].src=`assets/media/negac${i+1}_hit.png`:loadedImages[1][i].src=`assets/media/negac${i+1}_hit_eng.png`;return loadedImages},loadedImages=preLoadImages(),addZeroLeft=number=>number>=10?number:`0${number}`,printTimer=(min,sec)=>clock.innerHTML=`${addZeroLeft(min)}:${addZeroLeft(sec)}`,clearTimer=()=>printTimer(1,0),showResult=(counter,level)=>{let pointsSpan=document.querySelector("#points"),showLevel=document.querySelector("#end-level");"pt-BR"===document.documentElement.lang?("easy"===level&&(showLevel.innerHTML="fácil"),"normal"===level&&(showLevel.innerHTML="normal"),"hard"===level&&(showLevel.innerHTML="difícil")):showLevel.innerHTML=level,pointsSpan.innerHTML=counter,resultScreen.style.display="block"},resetGame=()=>{gameOn=!1,clearTimer(),location.reload()},startTimer=()=>{let min=0,sec=60;const changeTimer=()=>{min=0,sec--,printTimer(min,sec)};return new Promise((resolve,reject)=>{const timerInterval=setInterval(()=>{paused||(changeTimer(),0===min&&0===sec&&(clearInterval(timerInterval),resolve(!0)))},1e3)})},createTargets=()=>{document.querySelectorAll(".target").forEach(thisImg=>thisImg.remove());let randomNum=Math.floor(3*Math.random()),target=loadedImages[0][randomNum],targetHit=loadedImages[1][randomNum];gameScreen.appendChild(target),gameScreen.appendChild(targetHit),target.style.display="block",targetHit.style.display="none";let maxLeft=target.parentElement.offsetWidth-100,maxTop=target.parentElement.offsetHeight-100,randomLeftPos=Math.floor(Math.random()*(maxLeft-5)+5),randomTopPos=Math.floor(Math.random()*(maxTop-5)+5),randomHeight=Math.floor(40*Math.random()+50),targets=[target,targetHit];return targets.forEach(thisTarget=>{thisTarget.className="target",thisTarget.style.left=randomLeftPos+"px",thisTarget.style.top=randomTopPos+"px",thisTarget.style.width=.8*randomHeight+"px",thisTarget.style.height=randomHeight+"px"}),targets},createCloroqText=()=>{let cloroqTxt=gameScreen.appendChild(document.createElement("h1"));return cloroqTxt.style.color="rgb(218, 52, 52)",cloroqTxt.style.fontSize="60px","pt-BR"===document.documentElement.lang?cloroqTxt.innerHTML="CLOROQUINA!":cloroqTxt.innerHTML="CHLOROQUINE!",cloroqTxt},createCloroq=(leftPos,topPos)=>{let cloroqTxt=createCloroqText(),cloroq=loadedImages[2];cloroq.className="target cloroq",gameScreen.appendChild(cloroq),cloroq.style.left=leftPos,cloroq.style.top=topPos,cloroq.style.width="51px",cloroq.style.height="100px",cloroq.className+=" animate",setTimeout(()=>{cloroq.remove()},850),setTimeout(()=>{cloroqTxt.remove()},1100)},createSerynge=(leftPos,topPos)=>{let serynge=loadedImages[3],left=leftPos+35,top=topPos+30;serynge.className="serynge",gameScreen.appendChild(serynge),serynge.style.left=left+"px",serynge.style.top=top+"px",serynge.style.width="38px",serynge.style.height="55px",setTimeout(()=>{serynge.remove()},300)},endGame=async()=>await startTimer(),runGame=level=>{let targetClicked=!1,speed;gameOn=!0,"easy"===level&&(speed=1300),"normal"===level&&(speed=1e3),"hard"===level&&(speed=800);const gameInterval=setInterval(()=>{if(paused)return;const targets=createTargets();targets[0].addEventListener("click",e=>{!1===targetClicked&&(targets[0].style.display="none",targets[1].style.display="block",counter+=1,targetClicked=!0,0!==navigator.maxTouchPoints&&createSerynge(targets[1].offsetLeft,targets[1].offsetTop),counter>1&&counter%10==0&&createCloroq(targets[1].style.left,targets[1].style.top),setTimeout(()=>{targets[1].style.display="none",targetClicked=!1},.8*speed))}),countHits.innerHTML=counter},speed);endGame().then(resolve=>{resolve&&(clearInterval(gameInterval),document.querySelector(".target").remove(),setTimeout(()=>{showResult(counter,level)},speed))})},newGame=()=>{paused=!0;const alert=document.querySelector(".alert");alert.style.display="block",document.querySelector("#yes").addEventListener("click",()=>resetGame()),document.querySelector("#no").addEventListener("click",()=>{alert.style.display="none",paused=!1})},checkLevel=()=>{let level;const radios=document.querySelectorAll(".level");return radios.forEach(thisRadio=>{thisRadio.checked&&(level=thisRadio.value)}),level};btnIniciar.addEventListener("click",e=>{let level=checkLevel();resultScreen.style.display="none",void 0!==level?(startOptions.style.display="none",gameOn?newGame():runGame(level)):(e.preventDefault(),document.querySelector("#choose-level").innerHTML="Escolha o nível!")}),clearTimer()};onLoadGlobal();